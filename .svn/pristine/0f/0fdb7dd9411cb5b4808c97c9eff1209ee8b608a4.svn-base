webpackJsonp([3],{GgDs:function(e,t,a){"use strict";var s=a("8+FI"),l=a("gyMJ"),i={data:function(){var e=this;return{collapse:!1,fullscreen:!1,name:"admin",user:{},dialogVisible:!1,editVisible:!1,form:{username:"",password:""},edit:{newpwd:"",oldpwd:"",pwd:""},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},edit_rules:{oldpwd:[{required:!0,message:"请输入旧密码",trigger:"blur"}],newpwd:[{required:!0,message:"请输入新密码",trigger:"blur"}],pwd:[{validator:function(t,a,s){return a?a!=e.edit.newpwd?s(new Error("两次密码输入不一致！")):void s():s(new Error("密码不能为空！"))},trigger:"blur"}]}}},created:function(){var e=this;s.a.$on("login",function(t){"login"==t?e.dialogVisible=!0:e.$message.error(t)}),this.user=JSON.parse(sessionStorage.getItem("user")),this.user&&(this.form.username=this.user.username,this.name=this.user.name?this.user.name:"系统管理员")},methods:{handleCommand:function(e){0===e&&(sessionStorage.removeItem("ms_username"),sessionStorage.removeItem("user"),sessionStorage.removeItem("token"),this.$router.push("/login")),1===e&&(this.editVisible=!0)},updatePWD:function(){var e=this;this.$refs.edit.validate(function(t){if(!t)return!1;var a=new FormData;return a.append("oldpwd",e.edit.oldpwd),a.append("pwd",e.edit.pwd),l.c("/common/user/updatepwd",a).then(function(t){t.data&&(e.editVisible=!1,e.$message.success("修改成功"))}),!1})},login:function(){var e=this;this.$refs.form.validate(function(t){if(!t)return!1;var a=new FormData;a.append("username",e.form.username),a.append("password",e.form.password);var s=localStorage.getItem("role");return a.append("role",s),l.c("/admin/login",a).then(function(t){t&&200===parseInt(t.code)?(e.dialogVisible=!1,e.$message.success("登录成功")):e.$message.error(t.msg)}),!1})},collapseChage:function(){this.collapse=!this.collapse,s.a.$emit("collapse",this.collapse)},handleFullScreen:function(){var e=document.documentElement;this.fullscreen?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen():e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullScreen?e.webkitRequestFullScreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen(),this.fullscreen=!this.fullscreen}}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"header"},[a("div",{staticClass:"collapse-btn",on:{click:e.collapseChage}},[a("i",{staticClass:"el-icon-menu"})]),e._v(" "),a("div",{staticClass:"logo"},[e._v("内江市总工会奖品兑换管理系统")]),e._v(" "),a("div",{staticClass:"header-right"},[a("div",{staticClass:"header-user-con"},[a("div",{staticClass:"headline",on:{click:function(t){e.handleCommand(1)}}},[a("i",{staticClass:"el-icon-edit-outline"},[e._v("修改密码")])]),e._v(" "),a("div",{staticClass:"headline",on:{click:function(t){e.handleCommand(0)}}},[a("i",{staticClass:"el-icon-logout-qiehuanzuhu"},[e._v("退出")])]),e._v(" "),a("div",{staticClass:"btn-fullscreen",on:{click:e.handleFullScreen}},[a("el-tooltip",{attrs:{effect:"dark",content:e.fullscreen?"取消全屏":"全屏",placement:"bottom"}},[a("i",{staticClass:"el-icon-rank"})])],1)])]),e._v(" "),a("el-dialog",{attrs:{title:"登录",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"账号",prop:"username"}},[a("el-input",{directives:[{name:"mode",rawName:"v-mode",value:e.form.username,expression:"form.username"}]})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.login}},[e._v("登录")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"密码修改",visible:e.editVisible,width:"600px"},on:{"update:visible":function(t){e.editVisible=t}}},[a("el-form",{ref:"edit",attrs:{model:e.edit,rules:e.edit_rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"旧密码",prop:"oldpwd"}},[a("el-input",{attrs:{type:"password"},model:{value:e.edit.oldpwd,callback:function(t){e.$set(e.edit,"oldpwd",t)},expression:"edit.oldpwd"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"新密码",prop:"newpwd"}},[a("el-input",{attrs:{type:"password"},model:{value:e.edit.newpwd,callback:function(t){e.$set(e.edit,"newpwd",t)},expression:"edit.newpwd"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"重复新密码",prop:"pwd"}},[a("el-input",{attrs:{type:"password"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.updatePWD(t):null}},model:{value:e.edit.pwd,callback:function(t){e.$set(e.edit,"pwd",t)},expression:"edit.pwd"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.updatePWD}},[e._v("确定")])],1)],1)],1)},staticRenderFns:[]};var r=a("VU/8")(i,n,!1,function(e){a("SyxJ")},"data-v-a662596c",null);t.a=r.exports},PbRb:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("gyMJ"),l={name:"BusRecord",components:{vHead:a("GgDs").a},data:function(){return{id:"",tableData:[],cur_page:1,total:1,idx:-1,visible:!1,form:{},msg:"兑换成功",msgV:!1,tips:!1,nickname:"",status:"",st:[{value:0,label:"未兑换"},{value:1,label:"已兑换"}],tipsForm:{id:"",nickname:"暂无信息",activity:"暂无信息",prize:"暂无信息",end_time:"暂无信息",status:"暂无信息"}}},created:function(){this.getData()},methods:{handleCurrentChange:function(e){this.cur_page=e,this.getData()},getData:function(e){var t=this,a={page:1,nickname:this.nickname,status:this.status};1===e&&(a={page:1}),2!==e||this.id?(2===e&&(a={page:1,id:this.id}),Object(s.a)("/business/record",a).then(function(a){t.tableData=a.data||[],t.total=a.count||1,1==e&&t.$message.success("已刷新"),2===e&&a.data&&a.data.length>0&&(t.tipsForm=a.data[0],t.tips=!0)})):this.$message.error("请输入编码")},getActivity:function(e){var t=this;Object(s.a)("/business/record/getActivity",{id:e}).then(function(e){t.visible=!0,t.form=e.data||{}})},add:function(e){var t=this;if(e){var a=new FormData;a.append("id",e),Object(s.c)("/business/record/save",a).then(function(e){200===e.code?(t.tips=!1,t.msg="兑换成功，请发放实物",t.msgV=!0,t.id="",t.getData()):(t.msg=e.msg,t.msgV=!0)})}else this.$message.success("请输入编码")}}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"wrapper"},[a("v-head"),e._v(" "),a("el-container",{staticClass:"content"},[a("el-header",[a("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:"奖品编码",autofocus:"autofocus",clearable:""},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.getData(2)}},model:{value:e.id,callback:function(t){e.id=t},expression:"id"}}),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){e.getData(2)}}},[e._v("兑奖")]),e._v(" "),a("el-input",{staticClass:"handle-input-1",staticStyle:{"margin-left":"50px"},attrs:{placeholder:"领奖用户"},model:{value:e.nickname,callback:function(t){e.nickname=t},expression:"nickname"}}),e._v(" "),a("el-select",{staticClass:"handle-input-1",attrs:{clearable:"",placeholder:"兑换状态"},model:{value:e.status,callback:function(t){e.status=t},expression:"status"}},e._l(e.st,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.getData(0)}}},[e._v("查询")]),e._v(" "),a("el-tooltip",{staticStyle:{float:"right"},attrs:{content:"刷新",placement:"top"}},[a("el-button",{attrs:{icon:"el-icon-refresh",circle:""},on:{click:function(t){e.getData(1)}}})],1)],1),e._v(" "),a("el-main",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","highlight-current-row":""}},[a("el-table-column",{attrs:{type:"index",width:"30"}}),e._v(" "),a("el-table-column",{attrs:{prop:"id",label:"奖品编码",width:"240","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"nickname",label:"中奖用户",width:"140"}}),e._v(" "),a("el-table-column",{attrs:{prop:"telphone",label:"用户电话",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"activity",label:"抽奖活动","show-overflow-tooltip":!0,width:"200"}}),e._v(" "),a("el-table-column",{attrs:{prop:"prize",label:"获得奖品"}}),e._v(" "),a("el-table-column",{attrs:{prop:"creatime",label:"中奖日期",width:"140"}}),e._v(" "),a("el-table-column",{attrs:{prop:"end_time",label:"失效日期",width:"140"}}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"奖品状态",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.status?a("el-tag",[e._v("未兑换")]):1==t.row.status?a("el-tag",{attrs:{type:"success"}},[e._v("已兑换")]):2==t.row.status?a("el-tag",{attrs:{type:"danger"}},[e._v("已过期")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"flushtime",label:"兑换日期",width:"140"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"100",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(a){e.getActivity(t.row.activity_id)}}},[e._v("活动详情")])]}}])})],1),e._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{layout:"total,prev, pager, next",total:e.total,background:""},on:{"current-change":e.handleCurrentChange}})],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.msgV,width:"400px"},on:{"update:visible":function(t){e.msgV=t}}},[a("div",{staticClass:"del-dialog-cnt"},[e._v(e._s(e.msg))]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.msgV=!1}}},[e._v("确定")])],1)]),e._v(" "),a("el-dialog",{attrs:{visible:e.tips,width:"600px"},on:{"update:visible":function(t){e.tips=t}}},[a("el-form",{staticClass:"a-span",attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"奖品编码"}},[a("span",[e._v(e._s(e.tipsForm.id))])]),e._v(" "),a("el-form-item",{attrs:{label:"中奖用户"}},[a("span",[e._v(e._s(e.tipsForm.nickname))])]),e._v(" "),a("el-form-item",{attrs:{label:"抽奖活动"}},[a("span",[e._v(e._s(e.tipsForm.activity))])]),e._v(" "),a("el-form-item",{attrs:{label:"获得奖品"}},[a("span",[e._v(e._s(e.tipsForm.prize))])]),e._v(" "),a("el-form-item",{attrs:{label:"中奖日期"}},[a("span",[e._v(e._s(e.tipsForm.creatime))])]),e._v(" "),a("el-form-item",{attrs:{label:"失效日期"}},[a("span",[e._v(e._s(e.tipsForm.end_time))])]),e._v(" "),a("el-form-item",{attrs:{label:"奖品状态"}},[0==e.tipsForm.status?a("span",[e._v("未兑换")]):1==e.tipsForm.status?a("span",{staticStyle:{color:"#5daf34"}},[e._v("已兑换")]):2==e.tipsForm.status?a("span",{staticStyle:{color:"red"}},[e._v("已过期")]):e._e()])],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.tips=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.add(e.tipsForm.id)}}},[e._v("确定兑换")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"活动详情",visible:e.visible,width:"60%"},on:{"update:visible":function(t){e.visible=t}}},[a("el-form",{staticClass:"a-span",attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"标题"}},[a("span",[e._v(e._s(e.form.name))])]),e._v(" "),a("el-form-item",{attrs:{label:"开始日期"}},[a("span",[e._v(e._s(e.form.start_date))])]),e._v(" "),a("el-form-item",{attrs:{label:"截止日期"}},[a("span",[e._v(e._s(e.form.close_date))])]),e._v(" "),a("el-form-item",{attrs:{label:"活动简介"}},[a("span",[e._v(e._s(e.form.info))])])],1)],1)],1)},staticRenderFns:[]};var n=a("VU/8")(l,i,!1,function(e){a("T/s3")},"data-v-a73bd06e",null);t.default=n.exports},SyxJ:function(e,t){},"T/s3":function(e,t){}});